{% extends "archive_chan/base.html" %}
{% load i18n %}
{% load archive_chan_filters %}

{% block header_link %}<a href="{% url 'archive_chan:board' board_name %}">/{{ board_name }}/</a>{% endblock %}

{% block nav_link %}
    {% include 'archive_chan/nav_board.html' %}
{% endblock %}

{% block inner_head %}
    <script>
        var info_data = {
            board_name: '{{ board_name }}'
        };
    </script>
{% endblock %}

{% block content %}
    <div class="content">
        <div class="wrapper board-wrapper">
            
            <ul id="threads">
                {% for thread in thread_list %}
                    {% if thread.saved %}
                        <li class="thread-saved">
                    {% else %}
                        <li>
                    {% endif %}
                        <a href="{% url 'archive_chan:thread' board_name thread.number %}">

                            {% with thread.first_post as post %}
                                <div class="img-container">
                                    {% with post.image as image %}
                                        <img src="{{ image.thumbnail.url }}">
                                    {% endwith %}
                                </div>

                                <div class="thread-info">
                                    <div class="thread-info-time">
                                        last <time class="timeago" datetime="{{ thread.last_reply|date:"c" }}">{{ thread.last_reply }}</time>
                                    </div>
                                    <div class="thread-info-stats">
                                        <i class="fa fa-comment-o"></i> {{ thread.replies_count|add:"-1" }}
                                        <i class="fa fa-picture-o"></i> {{ thread.images_count|add:"-1" }}
                                    </div>
                                </div>

                                <div class="thread-tags">
                                    {% for tag in thread.tags.all %}
                                        <div>{{ tag.name }}</div>
                                    {% endfor %}
                                </div>

                                {% if post.subject %}
                                    <div class="thread-subject">{{post.subject}}</div>
                                {% endif %}

                                {% if post.comment %}
                                    <div class="thread-comment">{{post.comment}}</div>
                                {% endif %}
                            {% endwith %}

                        </a>
                    </li>
                {% endfor %}
            </ul>

            <div class="board-sidebar">
                {% include "archive_chan/board_filters.html" %}
            </div>
        </div>
    </div>

    {% if is_paginated %}
        <div class="content">
            <div class="wrapper">
                <div class="pagination">
                    {% if page_obj.has_previous %}
                        <a href="{% url 'archive_chan:board' board_name %}{% board_url_query  %}&page={{ page_obj.previous_page_number }}" class="page-prev" title="{% trans "Previous page" %}"><i class="fa fa-angle-left"></i></a>
                    {% endif %}
                    <div class="page-current">
                        {% blocktrans with current_page=page_obj.number all_pages=page_obj.paginator.num_pages %}
                            Page {{ current_page }} of {{ all_pages }}
                        {% endblocktrans %}
                    </div>
                    {% if page_obj.has_next %}
                        <a href="{% url 'archive_chan:board' board_name %}{% board_url_query  %}&page={{ page_obj.next_page_number }}" class="page-next" title="{% trans "Next page" %}"><i class="fa fa-angle-right"></i></a>
                    {% endif %}
                </div>
            </div>
        </div>
    {% endif %}
{% endblock %}


{% block inner_footer %}
    <ul class="additional-links">
        <li><a href="{% url 'archive_chan:board_stats' board_name %}"><i class="fa fa-bar-chart-o fa-fw"></i> Board statistics</a></li>
    </ul>
{% endblock %}
