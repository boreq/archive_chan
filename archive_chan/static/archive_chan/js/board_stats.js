google.load("visualization","1",{packages:["corechart"]});google.setOnLoadCallback(update);var statsData,timeout;$(window).resize(function(){drawChart(statsData)});$(document).ready(function(){$(".last-update-info").on("click","#update-now",function(){update()})});function update(){clearTimeout(timeout);$("#update-now i").addClass("fa-spin");var a=$.ajax({url:dataUrl,dataType:"json"}).done(function(c){statsData=c;drawStats(c);drawChart(c);timeout=setTimeout(update,15*1000);var b=new Date();$("#last-update").attr("datetime",b.toISOString()).attr("title",b).data("timeago",null).timeago();$("#update-now i").removeClass("fa-spin")})}function drawStats(a){$("#value-total-threads").text(a.total_threads);$("#value-total-posts").text(a.total_posts);$("#value-total-text").text(a.total_posts-a.total_image_posts);$("#value-total-image").text(a.total_image_posts);$("#value-average-hour").text(Math.round(a.recent_posts/a.recent_posts_timespan));if(a.total_threads>0){$("#value-average-thread").text(Math.round(a.total_posts/a.total_threads))}else{$("#value-average-thread").text("0")}if(a.total_posts>0){$("#value-percent-image").text(Math.round(a.total_image_posts/a.total_posts*100)+"%")}else{$("#value-percent-image").text("0%")}}function drawChart(d){var a={fontSize:12,chartArea:{left:50,top:10,right:100,bottom:0,width:"100%"},legend:{position:"none"},tooltip:{isHtml:true},series:[{color:"#65c6bb"}],curveType:"function"};var c=new google.visualization.DataTable(d.chart_data);var b=new google.visualization.LineChart(document.getElementById("chart"));b.draw(c,a)};